<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" href="Navbar_Images/tab_icon1.png" type="image/png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="JQ_and_BS/bootstrap.min.css">
  <link rel="stylesheet" href="css/home.css">
  <link rel="stylesheet" href="fontawesome-free-5.13.0-web/css/all.css">
  <link rel="stylesheet" href="css/bootstrap.min.css">
    <script src="JQ_and_BS/jquery-3.2.1.slim.min.js"></script>
    <script src="js/jquery-3.4.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Jost:wght@500&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Overpass:wght@600&display=swap" rel="stylesheet">
   <link href="https://fonts.googleapis.com/css?family=Josefin+Sans&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Oswald&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Lato&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Sen&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=PT+Sans+Caption&display=swap" rel="stylesheet">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BirchTree | Reset Password</title>
    <link rel="stylesheet" href="CSS_Files/resetPasword.css">
    

</head>
<body>

    <script>
        $(document).ready(function(){

      /* ANIMATIONS */    
      $('.alert1').hide();
      $('.alert2').hide();
      $('#an').hide();

      /* PANEL 1 */
      //$('.i1').hide();
      //$('.i2').hide();
      //$('.done').hide();
      //$('.title1').hide();

      /* PANEL 2 */
      $('.i3').hide();
      $('.done1').hide();
      $('.title2').hide();
      $('.bar-cont').hide();

      /* PANEL 3 */
      $('.title3').hide();
      $('.tick').hide();
      
  });

    </script>

<script>
    if (sessionStorage.getItem("loadRp")==null )
{
  var myVar;
  myVar = setTimeout(showPage, 1000);
}

else
{
  document.onreadystatechange = function() { 
    if (document.readyState === "complete") { 
        document.getElementById("animation_body").style.display = "block"; 
        document.getElementById("animation").style.display = "none"; 
    }  
  };
}

function showPage() 
{
  document.getElementById("animation_body").style.display = "block"; 
  document.getElementById("animation").style.display = "none"; 
  sessionStorage.setItem("loadRp",1);
}   

  </script>

  <div class="animation" id="animation">
    <img src="Navbar_Images/load.png" class="load_logo">
    <img src="Navbar_Images/load.gif" class="load_anim">
  </div>

  <div class="animation_body" id="animation_body">

    <div class="cont">

        <img src="SN_Images/img5.jpg" class="img">

        <img src="Navbar_Images/tick.png" class="tick" id="tick">

        <p class="title">Reset Password</p>

        <p class="title1" id="title1">Verify your identity first</p>
        <p class="title2" id="title2">Identity verified. Now pick a new password</p>
        <p class="title3" id="title3">Password changed!</p>

        <div class="input-group i1" id="i1">
            <button class="btn b" type="button">
            <i class="fa fa-user-circle ic"></i> </button>
            <input class="in" placeholder="Username" type="text" id="user" autocomplete="off">
        </div>

        <div class="input-group i2" id="i2">
            <button class="btn b" type="button">
            <i class="fa fa-question ic"></i> </button>
            <input class="in" placeholder="Security Qs: Name your first school" id="sqs" autocomplete="off">
        </div>

        <div class="input-group i3" id="i3">
          <button class="btn b" type="button">
          <i class="fa fa-lock ic"></i> </button>
          <input class="in" placeholder="Enter New Password" type="password" id="psw1" autocomplete="off" onkeyup="check_psw()">
      </div>

      <div class="bar-cont" id="bar-cont">
        <p id="bar-text" id="bar-text"></p>
    </div>

        <img src="Navbar_Images/tri2.png" class="alert1" id="alert1">
        <div class="alert2" id="alert2">
        <span class="popuptext" id="al">Alert
        </span></div>

        <img src="Navbar_Images/load1.gif" id="an">

        <button class="done btn" id="done" onclick="check()">Proceed</button>
        <button class="done1 btn" id="done1" onclick="reset()">Reset</button>


        <p class="para"><a href="Sign_Up.html" class="link">Sign Up</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="Index.html" class="link">Home</a></p>


    </div>

    <script>

function check_psw()
  {
    document.getElementById('bar-cont').style.opacity="1";
    document.getElementById('bar-text').style.opacity="1";
    var a0=document.getElementById("psw1").value;
    var a=a0.length;
    var sp=/[*,.;()""?!&''/^%@|:<>-]/g, num=/[0-9]/g, letters=/[a-z]/g;
    var sp1=a0.match(sp), num1=a0.match(num), letters1=a0.match(letters);

    if ((num1==null && sp1==null && a!=0 && letters1!=null) || (num1!=null && sp1==null && a!=0 && letters1==null) || (num1==null && sp1!=null && a!=0 && letters1==null) ) 
    { 
        document.getElementById('bar-cont').style.width="23.33%";
        document.getElementById('bar-cont').style.background="rgb(212, 64, 93)";
        document.getElementById('bar-cont').style.transition="0.5s";
        document.getElementById('bar-text').innerHTML="Weak";
    }
    else if ((num1!=null && sp1==null && a>5 && letters1!=null)
    || (num1==null && sp1!=null && a>5 && letters1!=null)
    ) 
    { 
        document.getElementById('bar-cont').style.width="46.66%";
        document.getElementById('bar-cont').style.background="rgb(233, 152, 1)";
        document.getElementById('bar-cont').style.transition="1s";
        document.getElementById('bar-text').innerHTML="Moderate"; 
    }
    else if (num1!=null && sp1!=null && a>7 && letters1!=null) 
    { 
        document.getElementById('bar-cont').style.width="70%";
        document.getElementById('bar-cont').style.background="rgb(99, 190, 99)";
        document.getElementById('bar-cont').style.transition="1s";
        document.getElementById('bar-text').innerHTML="Strong";
    }

    else if (a==0) 
    { 
        document.getElementById('bar-cont').style.width="0%"; 
        document.getElementById('bar-cont').style.transition="0s";
        document.getElementById('bar-text').innerHTML="";
        document.getElementById('bar-cont').style.opacity="0";
      document.getElementById('bar-text').style.opacity="0";
    }
  }     

function check()
{
    var t=document.getElementById("user").value, u=document.getElementById("sqs").value;
    var l1=t.length, t1=t+l1;

    if (t=="" && u=="")
    {
      $(document).ready(function(){
    document.getElementById('alert1').style.opacity="1";
    document.getElementById('alert2').style.opacity="1";
    document.getElementById('al').innerHTML="Both fields are empty!";
    $('.alert1').show(); $('.alert2').show(); }); setTimeout(alertg,2000); 
    return; 
    }
 
    if (t=="")
    {
      $(document).ready(function(){
    document.getElementById('alert1').style.opacity="1";
    document.getElementById('alert2').style.opacity="1";
    document.getElementById('al').innerHTML="Please enter a username!";
    $('.alert1').show(); $('.alert2').show(); }); setTimeout(alertg,2000); 
    return; 
    }

    if (u=="")
    {
      $(document).ready(function(){
    document.getElementById('alert1').style.opacity="1";
    document.getElementById('alert2').style.opacity="1";
    document.getElementById('al').innerHTML="Please enter an answer!";
    $('.alert1').show(); $('.alert2').show(); }); setTimeout(alertg,2000); 
    return; 
    }

    if (sessionStorage.getItem("data")==null) 
    {
      $(document).ready(function(){
    document.getElementById('alert1').style.opacity="1";
    document.getElementById('alert2').style.opacity="1";
    document.getElementById('al').innerHTML="Not registered!";
    $('.alert1').show(); $('.alert2').show(); }); setTimeout(alertg,2000); 
    return; 
    }

    var sq_data=sessionStorage.getItem("sques"), data=sessionStorage.getItem("data");
    var user_check=data.includes(t1), sqc=t1+"/"+u+u.length;
    var sq_check=sq_data.includes(sqc);

    if (user_check==false)
    {
      $(document).ready(function(){
    document.getElementById('alert1').style.opacity="1";
    document.getElementById('alert2').style.opacity="1";
    document.getElementById('al').innerHTML="Not registered!";
    $('.alert1').show(); $('.alert2').show(); }); setTimeout(alertg,2000); 
    return;
    }

    if (user_check==true && sq_check==false)
    {
      $(document).ready(function(){
    document.getElementById('alert1').style.opacity="1";
    document.getElementById('alert2').style.opacity="1";
    document.getElementById('al').innerHTML="Wrong Answer!";
    $('.alert1').show(); $('.alert2').show(); }); setTimeout(alertg,2000); 
    return;
    }

    if (user_check==true && sq_check==true)
    {
      sessionStorage.setItem("user_id",t1);
      //document.getElementById('an').style.opacity="1";
      /*$(document).ready(function(){
      $('#an').show(); }); setTimeout(alertf,1500);  */
      alertf();
    }
   
}

function reset()
{
  
  var ps=document.getElementById("psw1").value;

  if (ps=="")
  {
    $(document).ready(function(){
    document.getElementById('alert1').style.opacity="1";
    document.getElementById('alert2').style.opacity="1";
    document.getElementById('al').innerHTML="Please enter a password!";
    $('.alert1').show(); $('.alert2').show(); }); setTimeout(alertg,2000); 
    return;
  }

  for (var i=0; i<ps.length; i++)
    {
        if (ps.substr(i,1)==" ")
      { 
        $(document).ready(function(){
        document.getElementById('alert1').style.opacity="1";
        document.getElementById('alert2').style.opacity="1";
        document.getElementById('al').innerHTML="No spaces in password!";
        $('.alert1').show(); $('.alert2').show(); }); setTimeout(alertg,2000); return; 
      }
    }

  var data1=sessionStorage.getItem("data"), quan1=sessionStorage.getItem("quan_data"), size1=sessionStorage.getItem("size_data"), curr1=sessionStorage.getItem("curr_data");
  var user=sessionStorage.getItem("user_id");
  var start_index=data1.search(user);
  var org_st="";

  for (var j=start_index; j<data1.length; j++)
  {
    if (data1.substr(j,1)=="/") { break; }
    org_st=org_st+data1.substr(j,1);
  }

  var new_st=user+"-"+ps+ps.length;
  data1=data1.replace(org_st,new_st);
  quan1=quan1.replace(org_st,new_st);
  size1=size1.replace(org_st,new_st);
  curr1=curr1.replace(org_st,new_st);
  sessionStorage.setItem("data",data1);
  sessionStorage.setItem("quan_data",quan1);
  sessionStorage.setItem("size_data",size1);
  sessionStorage.setItem("curr_data",curr1);

  sessionStorage.removeItem("user_id");

  

  final_done();

}

function alertg()
        {
            $(document).ready(function(){
            $('.alert1').hide(); $('.alert2').hide(); });
            document.getElementById('alert1').style.opacity="0";
            document.getElementById('alert2').style.opacity="0";
        }

        function alertf()
        {
            $(document).ready(function(){
            
              $('#an').show();
              $('.i1').hide(); 
              $('.i2').hide(); 
              $('.done').hide(); 
              $('.title1').hide();
              $('.title').hide(); 
              $('.para').hide(); 
              
            document.getElementById('an').style.opacity="1";
            document.getElementById('i1').style.opacity="0";
            document.getElementById('i2').style.opacity="0";
            document.getElementById('done').style.opacity="0";
            document.getElementById('title1').style.opacity="0";

            setTimeout(show_new,1500);

            function show_new()
            {
              $(document).ready(function(){
                $('.title').show(); 
                $('.para').show(); 
               $('.i3').show(); 
               $('.done1').show();
               $('.bar-cont').show();
               $('.title2').show();
               $('#an').hide();
               document.getElementById('i3').style.opacity="1";
               document.getElementById('an').style.opacity="0";
            document.getElementById('done1').style.opacity="1";
            document.getElementById('title2').style.opacity="1";
               });
            }
            }); 
            
        }


        function final_done()
        {
          $(document).ready(function(){
            
            $('.i1').hide();
            $('.para').hide();
            $('#an').hide(); 
            $('.i2').hide(); 
            $('.i3').hide();
            $('.bar-cont').hide(); 
            $('.done').hide(); 
            $('.done1').hide();  
            $('.title1').hide(); 
            $('.title2').hide(); 
            $('.title').hide();
            $('#an').show();
            document.getElementById('an').style.opacity="1";
            setTimeout(fd1,2000);

            function fd1()
            {
              $('#an').hide(); 
              document.getElementById('an').style.opacity="0";
              $('.title3').show(); 
              $('.tick').show(); 
              document.getElementById('title3').style.opacity="1";
              document.getElementById('tick').style.opacity="1";
              setTimeout(back_to_signin,2000);
            }
          });
           
        }

        function back_to_signin()
        {
          document.getElementById("animation_body").style.display = "none"; 
          document.getElementById("animation").style.display = "block";
          setTimeout(finalfun,1200);
          function finalfun()          
          { window.location.href="Sign_In.html"; }
        }
    
    </script>
    
    </div>
</body>
</html>